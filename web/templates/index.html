<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaxCloud Analyzer - Accueil</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="app-shell">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="brand">
                <div class="brand-icon">üì°</div>
                <div>
                    <p class="eyebrow">aurora</p>
                    <h2>FaxCloud</h2>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="/" class="nav-link active">Dashboard</a>
                <a href="/reports" class="nav-link">Rapports</a>
                <a class="nav-link muted" aria-disabled="true">Starter</a>
                <a class="nav-link muted" aria-disabled="true">Documentation</a>
                <a class="nav-link muted" aria-disabled="true">Multi niveau</a>
            </nav>

            <div class="sidebar-cta">
                <div class="cta-illustration">‚ú®</div>
                <div>
                    <p class="eyebrow">Get more features</p>
                    <h3>Passer √† l'offre compl√®te</h3>
                    <ul>
                        <li>12 mod√®les pr√™ts √† l'emploi</li>
                        <li>Rapports avanc√©s & filtres</li>
                        <li>Support prioritaire</li>
                    </ul>
                </div>
                <a class="btn ghost" href="/reports">Explorer</a>
            </div>
        </aside>

        <!-- MAIN AREA -->
        <div class="main-area">
            <header class="topbar">
                <div class="search">
                    <span>üîç</span>
                    <input type="search" placeholder="Rechercher un rapport, une p√©riode ou un client..." aria-label="Recherche">
                </div>
                <div class="topbar-actions">
                    <button class="icon-button" type="button">‚ùì</button>
                    <button class="icon-button" type="button">üîî</button>
                    <div class="avatar">FC</div>
                </div>
            </header>

            <main class="content">
                <section class="page-header">
                    <div>
                        <p class="eyebrow">Vue d'ensemble</p>
                        <h1>Contr√¥le global des rapports FAX</h1>
                        <p class="text-muted">Suivez vos importations, surveillez les erreurs et acc√©dez en un clic aux derniers rapports.</p>
                    </div>
                    <div class="chip-group">
                        <span class="chip primary">Temps r√©el</span>
                        <span class="chip soft">Synchronis√©</span>
                    </div>
                </section>

                <!-- METRICS GRID -->
                <section class="metrics-grid">
                    <article class="stat-card primary">
                        <div class="stat-top">
                            <div class="stat-icon">üìà</div>
                            <div>
                                <p class="label">Volume total</p>
                                <p class="stat-value" id="totalFax">{{ stats.get('total_fax', 0) }}</p>
                            </div>
                        </div>
                        <p class="muted">Fax cumul√©s sur tous les rapports.</p>
                    </article>

                    <article class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon soft">üóÇÔ∏è</div>
                            <div>
                                <p class="label">Rapports g√©n√©r√©s</p>
                                <p class="stat-value" id="totalReports">{{ stats.get('total_reports', 0) }}</p>
                            </div>
                        </div>
                        <p class="muted">Imports analys√©s et stock√©s.</p>
                    </article>

                    <article class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon soft">üõ°Ô∏è</div>
                            <div>
                                <p class="label">Erreurs d√©tect√©es</p>
                                <p class="stat-value danger" id="errorFax">{{ stats.get('total_errors', 0) }}</p>
                            </div>
                        </div>
                        <p class="muted">Anomalies et transmissions √©chou√©es.</p>
                    </article>

                    <article class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon soft">ü§ù</div>
                            <div>
                                <p class="label">Clients suivis</p>
                                <p class="stat-value" id="uniqueClients">{{ stats.get('unique_clients', 0) }}</p>
                            </div>
                        </div>
                        <p class="muted">Contrats actifs ou r√©cemment import√©s.</p>
                    </article>

                    <article class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon soft">‚úÖ</div>
                            <div>
                                <p class="label">Taux moyen</p>
                                <p class="stat-value success" id="successRate">{{ stats.get('avg_success_rate', 0) }}%</p>
                            </div>
                        </div>
                        <p class="muted">R√©ussite globale des transmissions.</p>
                    </article>
                </section>

                <!-- OVERVIEW ROW -->
                <section class="panel-grid">
                    <article class="panel chart-panel">
                        <div class="panel-header">
                            <div>
                                <p class="eyebrow">Performance</p>
                                <h3>Flux des envois & projections</h3>
                            </div>
                            <div class="chip-group">
                                <span class="legend"><span class="dot actual"></span> Valeur r√©elle</span>
                                <span class="legend"><span class="dot projected"></span> Projection</span>
                            </div>
                        </div>

                        <div class="mini-metrics">
                            <div>
                                <p class="label">Nouveaux rapports</p>
                                <strong id="newReports">0</strong>
                            </div>
                            <div>
                                <p class="label">Rapports moyens</p>
                                <strong id="avgReports">0</strong>
                            </div>
                            <div>
                                <p class="label">Sessions actives</p>
                                <strong>3.7M</strong>
                            </div>
                            <div>
                                <p class="label">Pages vues</p>
                                <strong>523K</strong>
                            </div>
                        </div>

                        <div class="chart-shell">
                            <svg viewBox="0 0 600 220" role="presentation">
                                <g stroke="#e5e7eb" stroke-width="1">
                                    <line x1="0" y1="200" x2="600" y2="200"/>
                                    <line x1="0" y1="150" x2="600" y2="150"/>
                                    <line x1="0" y1="100" x2="600" y2="100"/>
                                    <line x1="0" y1="50" x2="600" y2="50"/>
                                </g>
                                <path d="M10 140 C80 120, 120 180, 180 90 S300 120, 360 80 440 150, 520 100 590 140 590 140"
                                      fill="none" stroke="#6aa7ff" stroke-width="3" stroke-linecap="round"/>
                                <path d="M10 110 C80 90, 140 130, 200 70 S320 100, 380 60 460 120, 520 70 590 110 590 110"
                                      fill="none" stroke="#7acda6" stroke-width="3" stroke-linecap="round" stroke-dasharray="6 6"/>
                            </svg>
                        </div>
                    </article>

                    <article class="panel upload-panel">
                        <div class="panel-header">
                            <div>
                                <p class="eyebrow">Import</p>
                                <h3>D√©posez vos journaux FAX</h3>
                                <p class="text-muted">Analyse automatique des CSV ou XLSX avec g√©n√©ration imm√©diate de rapports.</p>
                            </div>
                            <span class="chip primary">CSV / XLSX</span>
                        </div>

                        <div class="drag-drop-zone" id="dragDropZone">
                            <div class="drag-drop-icon">‚¨ÜÔ∏è</div>
                            <p><strong>Glissez-d√©posez vos fichiers ici</strong></p>
                            <p class="text-or">ou</p>
                            <div class="action-row">
                                <label for="fileInput" class="btn primary">S√©lectionner un fichier</label>
                                <input type="file" id="fileInput" accept=".csv,.xlsx" style="display:none;">
                                <a href="/reports" class="btn ghost">Voir les rapports</a>
                            </div>
                            <small>Jusqu'√† 100MB ‚Ä¢ S√©curis√© ‚Ä¢ Analyse instantan√©e</small>
                        </div>

                        <div id="uploadProgress" class="progress-card hidden">
                            <div class="progress-header">
                                <p>Importation en cours...</p>
                                <span id="progressText">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                        </div>

                        <div id="uploadMessage" class="message-area"></div>

                        <div class="upload-footer">
                            <div>
                                <p class="label">Nettoyage</p>
                                <p class="text-muted">Purger l'historique et repartir √† z√©ro.</p>
                            </div>
                            <button id="clearBtn" class="btn danger ghost">üóëÔ∏è Effacer toutes les donn√©es</button>
                        </div>
                    </article>
                </section>

                <!-- REPORTS ROW -->
                <section class="panel-grid">
                    <article class="panel table-panel">
                        <div class="panel-header">
                            <div>
                                <p class="eyebrow">Suivi</p>
                                <h3>Derniers rapports g√©n√©r√©s</h3>
                            </div>
                            <a class="btn ghost" href="/reports">Tout voir</a>
                        </div>

                        <div class="entries-list">
                            <table class="entries-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Total FAX</th>
                                        <th>Envoy√©s</th>
                                        <th>Re√ßus</th>
                                        <th>Erreurs</th>
                                    </tr>
                                </thead>
                                <tbody id="reportsBody">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">Aucun rapport</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </article>

                    <article class="panel recap-panel">
                        <p class="eyebrow">Synth√®se</p>
                        <h3>Fiabilit√© & rythme</h3>
                        <p class="text-muted">Gardez un ≈ìil sur le volume global, le nombre de rapports et les erreurs d√©tect√©es.</p>

                        <div class="recap-grid">
                            <div>
                                <p class="label">Volume total</p>
                                <p class="stat-value" id="recapTotal">{{ stats.get('total_fax', 0) }}</p>
                                <span class="badge positive">R√©√©chantillonn√©</span>
                            </div>
                            <div>
                                <p class="label">Erreurs</p>
                                <p class="stat-value danger" id="recapErrors">{{ stats.get('total_errors', 0) }}</p>
                                <span class="badge warning">√Ä surveiller</span>
                            </div>
                            <div>
                                <p class="label">Clients</p>
                                <p class="stat-value" id="recapClients">{{ stats.get('unique_clients', 0) }}</p>
                                <span class="badge neutral">Actifs</span>
                            </div>
                        </div>

                        <div class="success-track">
                            <div class="success-value" id="recapSuccess">{{ stats.get('avg_success_rate', 0) }}%</div>
                            <div class="success-meta">
                                <p class="label">Taux moyen</p>
                                <p class="text-muted">R√©ussite des transmissions sur l'ensemble des rapports.</p>
                            </div>
                        </div>
                    </article>
                </section>
            </main>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
